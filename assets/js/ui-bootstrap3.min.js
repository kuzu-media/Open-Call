angular.module("ui.bootstrap",["ui.mask","ui.bootstrap.typeahead","ui.bootstrap.collapse"]);angular.module("ui.mask",[]).value("uiMaskConfig",{maskDefinitions:{9:/\d/,A:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/}}).directive("uiMask",["uiMaskConfig",function(e){return{priority:100,require:"ngModel",restrict:"A",compile:function(){var n=e;return function(t,r,i,s){function S(e){if(!angular.isDefined(e))return k();B(e);if(!o)return k();L();A();return!0}function x(e){if(!angular.isDefined(e))return;l=e;o&&q()}function T(e){if(!o)return e;p=_(e||"");v=M(p);s.$setValidity("mask",v);return v&&p.length?D(p):undefined}function N(e){if(!o)return e;p=_(e||"");v=M(p);s.$viewValue=p.length?D(p):"";s.$setValidity("mask",v);p===""&&s.$error.required!==undefined&&s.$setValidity("required",!1);return v?p:undefined}function k(){o=!1;O();angular.isDefined(m)?r.attr("placeholder",m):r.removeAttr("placeholder");angular.isDefined(g)?r.attr("maxlength",g):r.removeAttr("maxlength");r.val(s.$modelValue);s.$viewValue=s.$modelValue;return!1}function L(){p=b=_(s.$modelValue||"");d=y=D(p);v=M(p);var e=v&&p.length?d:"";i.maxlength&&r.attr("maxlength",a[a.length-1]*2);r.attr("placeholder",l);r.val(e);s.$viewValue=e}function A(){if(u)return;r.bind("blur",j);r.bind("mousedown mouseup",F);r.bind("input keyup click focus",q);u=!0}function O(){if(!u)return;r.unbind("blur",j);r.unbind("mousedown",F);r.unbind("mouseup",F);r.unbind("input",q);r.unbind("keyup",q);r.unbind("click",q);r.unbind("focus",q);u=!1}function M(e){return e.length?e.length>=h:!0}function _(e){var t="",n=f.slice();e=e.toString();angular.forEach(c,function(t){e=e.replace(t,"")});angular.forEach(e.split(""),function(e){if(n.length&&n[0].test(e)){t+=e;n.shift()}});return t}function D(e){var t="",n=a.slice();angular.forEach(l.split(""),function(r,i){if(e.length&&i===n[0]){t+=e.charAt(0)||"_";e=e.substr(1);n.shift()}else t+=r});return t}function P(e){var t=i.placeholder;return typeof t!="undefined"&&t[e]?t[e]:"_"}function H(){return l.replace(/[_]+/g,"_").replace(/([^_]+)([a-zA-Z0-9])([^_])/g,"$1$2_$3").split("_")}function B(e){var t=0;a=[];f=[];l="";if(typeof e=="string"){h=0;var n=!1,r=e.split("");angular.forEach(r,function(e,r){if(C.maskDefinitions[e]){a.push(t);l+=P(r);f.push(C.maskDefinitions[e]);t++;n||h++}else if(e==="?")n=!0;else{l+=e;t++}})}a.push(a.slice().pop()+1);c=H();o=a.length>1?!0:!1}function j(){w=0;E=0;if(!v||p.length===0){d="";r.val("");t.$apply(function(){s.$setViewValue("")})}}function F(e){e.type==="mousedown"?r.bind("mouseout",I):r.unbind("mouseout",I)}function I(){E=W(this);r.unbind("mouseout",I)}function q(e){e=e||{};var n=e.which,i=e.type;if(n===16||n===91)return;var o=r.val(),u=y,f,l=_(o),c=b,h=!1,p=U(this)||0,d=w||0,v=p-d,m=a[0],g=a[l.length]||a.slice().shift(),S=E||0,x=W(this)>0,T=S>0,N=o.length>u.length||S&&o.length>u.length-S,C=o.length<u.length||S&&o.length===u.length-S,k=n>=37&&n<=40&&e.shiftKey,L=n===37,A=n===8||i!=="keyup"&&C&&v===-1,O=n===46||i!=="keyup"&&C&&v===0&&!T,M=(L||A||i==="click")&&p>m;E=W(this);if(k||x&&(i==="click"||i==="keyup"))return;if(i==="input"&&C&&!T&&l===c){while(A&&p>m&&!R(p))p--;while(O&&p<g&&a.indexOf(p)===-1)p++;var P=a.indexOf(p);l=l.substring(0,P)+l.substring(P+1);h=!0}f=D(l);y=f;b=l;r.val(f);h&&t.$apply(function(){s.$setViewValue(l)});N&&p<=m&&(p=m+1);M&&p--;p=p>g?g:p<m?m:p;while(!R(p)&&p>m&&p<g)p+=M?-1:1;(M&&p<g||N&&!R(d))&&p++;w=p;z(this,p)}function R(e){return a.indexOf(e)>-1}function U(e){if(e.selectionStart!==undefined)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();t.moveStart("character",-e.value.length);return t.text.length}return 0}function z(e,t){if(e.offsetWidth===0||e.offsetHeight===0)return;if(e.setSelectionRange){e.focus();e.setSelectionRange(t,t)}else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0);n.moveEnd("character",t);n.moveStart("character",t);n.select()}}function W(e){return e.selectionStart!==undefined?e.selectionEnd-e.selectionStart:document.selection?document.selection.createRange().text.length:0}var o=!1,u=!1,a,f,l,c,h,p,d,v,m=i.placeholder,g=i.maxlength,y,b,w,E,C={};if(i.uiOptions){C=t.$eval("["+i.uiOptions+"]");angular.isObject(C[0])&&(C=function(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]?angular.extend(t[n],e[n]):t[n]=angular.copy(e[n]));return t}(n,C[0]))}else C=n;i.$observe("uiMask",S);i.$observe("placeholder",x);s.$formatters.push(T);s.$parsers.push(N);r.bind("mousedown mouseup",F);Array.prototype.indexOf||(Array.prototype.indexOf=function(e){"use strict";if(this===null)throw new TypeError;var t=Object(this),n=t.length>>>0;if(n===0)return-1;var r=0;if(arguments.length>1){r=Number(arguments[1]);r!==r?r=0:r!==0&&r!==Infinity&&r!==-Infinity&&(r=(r>0||-1)*Math.floor(Math.abs(r)))}if(r>=n)return-1;var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++)if(i in t&&t[i]===e)return i;return-1})}}}}]);angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position"]).factory("typeaheadParser",["$parse",function(e){var t=/^\s*(.*?)(?:\s+as\s+(.*?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+(.*)$/;return{parse:function(n){var r=n.match(t),i,s,o;if(!r)throw new Error("Expected typeahead specification in form of '_modelValue_ (as _label_)? for _item_ in _collection_' but got '"+n+"'.");return{itemName:r[3],source:e(r[4]),viewMapper:e(r[2]||r[1]),modelMapper:e(r[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function(e,t,n,r,i,s,o){var u=[9,13,27,38,40];return{require:"ngModel",link:function(a,f,l,c){var h=a.$eval(l.typeaheadMinLength)||1,p=a.$eval(l.typeaheadWaitMs)||0,d=a.$eval(l.typeaheadEditable)!==!1,v=t(l.typeaheadLoading).assign||angular.noop,m=t(l.typeaheadOnSelect),g=l.typeaheadInputFormatter?t(l.typeaheadInputFormatter):undefined,y=t(l.ngModel).assign,b=o.parse(l.typeahead),w=angular.element("<typeahead-popup></typeahead-popup>");w.attr({matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"});angular.isDefined(l.typeaheadTemplateUrl)&&w.attr("template-url",l.typeaheadTemplateUrl);var E=a.$new();a.$on("$destroy",function(){E.$destroy()});var S=function(){E.matches=[];E.activeIdx=-1},x=function(e){var t={$viewValue:e};v(a,!0);n.when(b.source(E,t)).then(function(n){if(e===c.$viewValue){if(n.length>0){E.activeIdx=0;E.matches.length=0;for(var r=0;r<n.length;r++){t[b.itemName]=n[r];E.matches.push({label:b.viewMapper(E,t),model:n[r]})}E.query=e;E.position=s.position(f);E.position.top=E.position.top+f.prop("offsetHeight")}else S();v(a,!1)}},function(){S();v(a,!1)})};S();E.query=undefined;var T;c.$parsers.unshift(function(e){S();if(e&&e.length>=h)if(p>0){T&&r.cancel(T);T=r(function(){x(e)},p)}else x(e);if(d)return e;c.$setValidity("editable",!1);return undefined});c.$formatters.push(function(e){var t,n,r={};if(g){r.$model=e;return g(a,r)}r[b.itemName]=e;t=b.viewMapper(a,r);r[b.itemName]=undefined;n=b.viewMapper(a,r);return t!==n?t:e});E.select=function(e){var t={},n,r;t[b.itemName]=r=E.matches[e].model;n=b.modelMapper(a,t);y(a,n);c.$setValidity("editable",!0);m(a,{$item:r,$model:n,$label:b.viewMapper(a,t)});S();f[0].focus()};f.bind("keydown",function(e){if(E.matches.length===0||u.indexOf(e.which)===-1)return;e.preventDefault();if(e.which===40){E.activeIdx=(E.activeIdx+1)%E.matches.length;E.$digest()}else if(e.which===38){E.activeIdx=(E.activeIdx?E.activeIdx:E.matches.length)-1;E.$digest()}else if(e.which===13||e.which===9)E.$apply(function(){E.select(E.activeIdx)});else if(e.which===27){e.stopPropagation();S();E.$digest()}});i.bind("click",function(){S();E.$digest()});f.after(e(w)(E))}}}]).directive("typeaheadPopup",function(){return{restrict:"E",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"app/views/bootstrap/typeahead-popup.html",link:function(e,t,n){e.templateUrl=n.templateUrl;e.isOpen=function(){return e.matches.length>0};e.isActive=function(t){return e.active==t};e.selectActive=function(t){e.active=t};e.selectMatch=function(t){e.select({activeIdx:t})}}}}).directive("typeaheadMatch",["$http","$templateCache","$compile","$parse",function(e,t,n,r){return{restrict:"E",scope:{index:"=",match:"=",query:"="},link:function(i,s,o){var u=r(o.templateUrl)(i.$parent)||"app/views/bootstrap/typeahead-match.html";e.get(u,{cache:t}).success(function(e){s.replaceWith(n(e.trim())(i))})}}}]).filter("typeaheadHighlight",function(){function e(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(t,n){return n?t.replace(new RegExp(e(n),"gi"),"<strong>$&</strong>"):n}});angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function(e){var t=function(e,t,n){t.removeClass("collapse");t.removeClass("in");t.removeClass("collapsing");t.css({height:n});var r=t[0].offsetWidth;t.addClass("collapse");t.addClass("in");t.addClass("collapsing")};return{link:function(n,r,i){var s,o=!0;n.$watch(function(){return r[0].scrollHeight},function(e){r[0].scrollHeight!==0&&(s||(o?t(n,r,r[0].scrollHeight+"px"):t(n,r,"auto")))});n.$watch(i.collapse,function(e){e?l():f()});var u,a=function(t){u&&u.cancel();u=e(r,t);u.then(function(){u=undefined},function(){u=undefined});return u},f=function(){if(o){o=!1;s||t(n,r,"auto")}else a({height:r[0].scrollHeight+"px"}).then(function(){s||t(n,r,"auto")});s=!1},l=function(){s=!0;if(o){o=!1;t(n,r,0)}else{t(n,r,r[0].scrollHeight+"px");a({height:"0"})}}}}}]).directive("collapse",["$transition",function(e){var t=function(e,t,n){t.removeClass("collapse");t.css({height:n});var r=t[0].offsetWidth;t.addClass("collapse")};return{link:function(n,r,i){var s,o=!0;n.$watch(function(){return r[0].scrollHeight},function(e){r[0].scrollHeight!==0&&(s||(o?t(n,r,r[0].scrollHeight+"px"):t(n,r,"auto")))});n.$watch(i.collapse,function(e){e?l():f()});var u,a=function(t){u&&u.cancel();u=e(r,t);u.then(function(){u=undefined},function(){u=undefined});return u},f=function(){console.log("element,element[0].scrollHeight",r,r[0].scrollHeight);if(o){o=!1;s||t(n,r,"auto")}else a({height:r[0].scrollHeight+"px"}).then(function(){s||t(n,r,"auto")});s=!1},l=function(){s=!0;if(o){o=!1;t(n,r,0)}else{t(n,r,r[0].scrollHeight+"px");a({height:"0"})}}}}}]);angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function(e,t){function n(e,n){return e.currentStyle?e.currentStyle[n]:t.getComputedStyle?t.getComputedStyle(e)[n]:e.style[n]}function r(e){return(n(e,"position")||"static")==="static"}var i=function(t){var n=e[0],i=t.offsetParent||n;while(i&&i!==n&&r(i))i=i.offsetParent;return i||n};return{position:function(t){var n=this.offset(t),r={top:0,left:0},s=i(t[0]);if(s!=e[0]){r=this.offset(angular.element(s));r.top+=s.clientTop-s.scrollTop;r.left+=s.clientLeft-s.scrollLeft}return{width:t.prop("offsetWidth"),height:t.prop("offsetHeight"),top:n.top-r.top,left:n.left-r.left}},offset:function(n){var r=n[0].getBoundingClientRect();return{width:n.prop("offsetWidth"),height:n.prop("offsetHeight"),top:r.top+(t.pageYOffset||e[0].body.scrollTop),left:r.left+(t.pageXOffset||e[0].body.scrollLeft)}}}}]);angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function(e,t,n){function u(e){for(var t in e)if(i.style[t]!==undefined)return e[t]}var r=function(i,s,o){o=o||{};var u=e.defer(),a=r[o.animation?"animationEndEventName":"transitionEndEventName"],f=function(e){n.$apply(function(){i.unbind(a,f);u.resolve(i)})};a&&i.bind(a,f);t(function(){angular.isString(s)?i.addClass(s):angular.isFunction(s)?s(i):angular.isObject(s)&&i.css(s);a||u.resolve(i)});u.promise.cancel=function(){a&&i.unbind(a,f);u.reject("Transition cancelled")};return u.promise},i=document.createElement("trans"),s={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},o={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};r.transitionEndEventName=u(s);r.animationEndEventName=u(o);return r}]);